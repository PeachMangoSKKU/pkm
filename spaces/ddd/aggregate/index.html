<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="Shihyu's personal knowledge management"><title>Shihyu's PKM</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=../../../icon.png><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Source+Sans+Pro:wght@400;700&family=Fira+Code:wght@400;700&display=swap" rel=stylesheet><style>:root{--light:#faf8f8;--dark:#141021;--secondary:#284b63;--tertiary:#84a59d;--visited:#afbfc9;--primary:#f28482;--gray:#4e4e4e;--lightgray:#f0f0f0;--outlinegray:#dadada}[saved-theme=dark]{--light:#1e1e21 !important;--dark:#fbfffe !important;--secondary:#5b778a !important;--visited:#4a575e !important;--tertiary:#84a59d !important;--primary:#f58382 !important;--gray:#d4d4d4 !important;--lightgray:#292633 !important;--outlinegray:#343434 !important}</style><style>:root{--lt-colours-light:var(--light) !important;--lt-colours-lightgray:var(--lightgray) !important;--lt-colours-dark:var(--secondary) !important;--lt-colours-secondary:var(--tertiary) !important;--lt-colours-gray:var(--outlinegray) !important}h1,h2,h3,h4,ol,ul,thead{font-family:Inter;color:var(--dark);font-weight:revert;margin:revert;padding:revert}p,ul,text{font-family:source sans pro,sans-serif;color:var(--gray);fill:var(--gray);font-weight:revert;margin:revert;padding:revert}a{font-family:Inter;font-weight:700;font-size:1em;text-decoration:none;transition:all .2s ease;color:var(--secondary)}a:hover{color:var(--tertiary)!important}#TableOfContents>ol{counter-reset:section;margin-left:0;padding-left:1.5em}#TableOfContents>ol>li{counter-increment:section}#TableOfContents>ol>li>ol{counter-reset:subsection}#TableOfContents>ol>li>ol>li{counter-increment:subsection}#TableOfContents>ol>li>ol>li::marker{content:counter(section)"." counter(subsection)"  "}#TableOfContents>ol>li::marker{content:counter(section)"  "}#TableOfContents>ol>li::marker,#TableOfContents>ol>li>ol>li::marker{font-family:Source Sans Pro;font-weight:700}footer{margin-top:4em;text-align:center}table{width:100%}img{width:100%;border-radius:3px;margin:1em 0}p>img+em{display:block;transform:translateY(-1em)}sup{line-height:0}p,tbody,li{font-family:Source Sans Pro;color:var(--gray);line-height:1.5em}h2{opacity:.85}h3{opacity:.75}blockquote{margin-left:0;border-left:3px solid var(--secondary);padding-left:1em;transition:border-color .2s ease}blockquote:hover{border-color:var(--tertiary)}table{padding:1.5em}td,th{padding:.1em .5em}.footnotes p{margin:.5em 0}article a{font-family:Source Sans Pro;font-weight:600;text-decoration:underline;text-decoration-color:var(--tertiary);text-decoration-thickness:.15em}sup>a{text-decoration:none;padding:0 .1em 0 .2em}pre{font-family:fira code;padding:.75em;border-radius:3px;overflow-x:scroll}code{font-family:fira code;font-size:.85em;padding:.15em .3em;border-radius:5px;background:var(--lightgray)}html{scroll-behavior:smooth}body{margin:0;height:100vh;width:100vw;overflow-x:hidden;background-color:var(--light)}@keyframes fadeIn{0%{opacity:0}100%{opacity:1}}footer{margin-top:4em}footer>a{font-size:1em;color:var(--secondary);padding:0 .5em 3em}hr{width:25%;margin:4em auto;height:2px;border-radius:1px;border-width:0;color:var(--dark);background-color:var(--dark)}a[href^="/"]{text-decoration:none;background-color:#afbfc922;padding:0 .2em;border-radius:3px}.singlePage{margin:4em 30vw}@media all and (max-width:1200px){.singlePage{margin:25px 5vw}}.page-end{display:flex;flex-direction:row}@media all and (max-width:780px){.page-end{flex-direction:column}}.page-end>*{flex:1 0}.page-end>.backlinks-container>ul{list-style:none;padding-left:0;margin-right:2em}.page-end>.backlinks-container>ul>li{margin:.5em 0;padding:.25em 1em;border:var(--outlinegray)1px solid;border-radius:5px}.page-end #graph-container{border:var(--outlinegray)1px solid;border-radius:5px}.centered{margin-top:30vh}header{display:flex;flex-direction:row;align-items:center}header>h1{font-size:2em}@media all and (max-width:600px){header>nav{display:none}}header>.spacer{flex:auto}header>svg{cursor:pointer;width:18px;min-width:18px;margin:0 1em}header>svg:hover .search-path{stroke:var(--tertiary)}header>svg .search-path{stroke:var(--gray);stroke-width:2px;transition:stroke .5s ease}#search-container{position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100%;overflow:scroll;display:none;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px)}#search-container>div{width:50%;margin-top:15vh;margin-left:auto;margin-right:auto}@media all and (max-width:1200px){#search-container>div{width:90%}}#search-container>div>*{width:100%;border-radius:4px;background:var(--light);box-shadow:0 14px 50px rgba(27,33,48,.12),0 10px 30px rgba(27,33,48,.16);margin-bottom:2em}#search-container>div>input{box-sizing:border-box;padding:.5em 1em;font-family:Inter,sans-serif;color:var(--dark);font-size:1.1em;border:1px solid var(--outlinegray)}#search-container>div>input:focus{outline:none}#search-container>div>#results-container>.result-card{padding:1em;cursor:pointer;transition:background .2s ease;border:1px solid var(--outlinegray);border-bottom:none;font-family:inherit;font-size:100%;line-height:1.15;margin:0;overflow:visible;text-transform:none;text-align:left;background:var(--light);outline:none}#search-container>div>#results-container>.result-card:hover,#search-container>div>#results-container>.result-card:focus{background:rgba(180,180,180,.15)}#search-container>div>#results-container>.result-card:first-of-type{border-top-left-radius:5px;border-top-right-radius:5px}#search-container>div>#results-container>.result-card:last-of-type{border-bottom-left-radius:5px;border-bottom-right-radius:5px;border-bottom:1px solid var(--outlinegray)}#search-container>div>#results-container>.result-card>h3,#search-container>div>#results-container>.result-card>p{margin:0}#search-container>div>#results-container>.result-card .search-highlight{background-color:#afbfc966;padding:.05em .2em;border-radius:3px}</style><style>.darkmode{float:right;padding:1em;min-width:30px;position:relative}@media all and (max-width:450px){.darkmode{padding:1em}}.darkmode>.toggle{display:none;box-sizing:border-box}.darkmode svg{opacity:0;position:absolute;width:20px;height:20px;top:calc(50% - 10px);margin:0 7px;fill:var(--gray);transition:opacity .1s ease}.toggle:checked~label>#dayIcon{opacity:0}.toggle:checked~label>#nightIcon{opacity:1}.toggle:not(:checked)~label>#dayIcon{opacity:1}.toggle:not(:checked)~label>#nightIcon{opacity:0}</style><style>.chroma{color:#f8f8f2;background-color:#282a36}.chroma .lntd{vertical-align:top;padding:0;margin:0;border:0}.chroma .lntable{border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block}.chroma .hl{display:block;width:100%;background-color:#ffc}.chroma .lnt{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .ln{margin-right:.4em;padding:0 .4em;color:#7f7f7f}.chroma .k{color:#ff79c6}.chroma .kc{color:#ff79c6}.chroma .kd{color:#8be9fd;font-style:italic}.chroma .kn{color:#ff79c6}.chroma .kp{color:#ff79c6}.chroma .kr{color:#ff79c6}.chroma .kt{color:#8be9fd}.chroma .na{color:#50fa7b}.chroma .nb{color:#8be9fd;font-style:italic}.chroma .nc{color:#50fa7b}.chroma .nf{color:#50fa7b}.chroma .nl{color:#8be9fd;font-style:italic}.chroma .nt{color:#ff79c6}.chroma .nv{color:#8be9fd;font-style:italic}.chroma .vc{color:#8be9fd;font-style:italic}.chroma .vg{color:#8be9fd;font-style:italic}.chroma .vi{color:#8be9fd;font-style:italic}.chroma .s{color:#f1fa8c}.chroma .sa{color:#f1fa8c}.chroma .sb{color:#f1fa8c}.chroma .sc{color:#f1fa8c}.chroma .dl{color:#f1fa8c}.chroma .sd{color:#f1fa8c}.chroma .s2{color:#f1fa8c}.chroma .se{color:#f1fa8c}.chroma .sh{color:#f1fa8c}.chroma .si{color:#f1fa8c}.chroma .sx{color:#f1fa8c}.chroma .sr{color:#f1fa8c}.chroma .s1{color:#f1fa8c}.chroma .ss{color:#f1fa8c}.chroma .m{color:#bd93f9}.chroma .mb{color:#bd93f9}.chroma .mf{color:#bd93f9}.chroma .mh{color:#bd93f9}.chroma .mi{color:#bd93f9}.chroma .il{color:#bd93f9}.chroma .mo{color:#bd93f9}.chroma .o{color:#ff79c6}.chroma .ow{color:#ff79c6}.chroma .c{color:#6272a4}.chroma .ch{color:#6272a4}.chroma .cm{color:#6272a4}.chroma .c1{color:#6272a4}.chroma .cs{color:#6272a4}.chroma .cp{color:#ff79c6}.chroma .cpf{color:#ff79c6}.chroma .gd{color:#8b080b}.chroma .ge{text-decoration:underline}.chroma .gh{font-weight:700}.chroma .gi{font-weight:700}.chroma .go{color:#44475a}.chroma .gu{font-weight:700}.chroma .gl{text-decoration:underline}.lntd:first-of-type>.chroma{padding-right:0}.chroma code{font-family:fira code!important;font-size:.85em;line-height:1em;background:0 0;padding:0}.chroma{border-radius:3px;margin:0}</style><script>const userPref=window.matchMedia('(prefers-color-scheme: light)').matches?'light':'dark',currentTheme=localStorage.getItem('theme')??userPref;currentTheme&&document.documentElement.setAttribute('saved-theme',currentTheme);const switchTheme=a=>{a.target.checked?(document.documentElement.setAttribute('saved-theme','dark'),localStorage.setItem('theme','dark')):(document.documentElement.setAttribute('saved-theme','light'),localStorage.setItem('theme','light'))};window.addEventListener('DOMContentLoaded',()=>{const a=document.querySelector('#darkmode-toggle');a.addEventListener('change',switchTheme,!1),currentTheme==='dark'&&(a.checked=!0)})</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/gh/nextapps-de/flexsearch@0.7.2/dist/flexsearch.bundle.js></script><script>const removeMarkdown=(c,b={listUnicodeChar:!1,stripListLeaders:!0,gfm:!0,useImgAltText:!1,preserveLinks:!1})=>{let a=c||"";a=a.replace(/^(-\s*?|\*\s*?|_\s*?){3,}\s*$/gm,"");try{b.stripListLeaders&&(b.listUnicodeChar?a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,b.listUnicodeChar+" $1"):a=a.replace(/^([\s\t]*)([\*\-\+]|\d+\.)\s+/gm,"$1")),b.gfm&&(a=a.replace(/\n={2,}/g,"\n").replace(/~{3}.*\n/g,"").replace(/~~/g,"").replace(/`{3}.*\n/g,"")),b.preserveLinks&&(a=a.replace(/\[(.*?)\][\[\(](.*?)[\]\)]/g,"$1 ($2)")),a=a.replace(/<[^>]*>/g,"").replace(/^[=\-]{2,}\s*$/g,"").replace(/\[\^.+?\](\: .*?$)?/g,"").replace(/\s{0,2}\[.*?\]: .*?$/g,"").replace(/\!\[(.*?)\][\[\(].*?[\]\)]/g,b.useImgAltText?"$1":"").replace(/\[(.*?)\][\[\(].*?[\]\)]/g,"$1").replace(/^\s{0,3}>\s?/g,"").replace(/(^|\n)\s{0,3}>\s?/g,"\n\n").replace(/^\s{1,2}\[(.*?)\]: (\S+)( ".*?")?\s*$/g,"").replace(/^(\n)?\s{0,}#{1,6}\s+| {0,}(\n)?\s{0,}#{0,} {0,}(\n)?\s{0,}$/gm,"$1$2$3").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/([\*_]{1,3})(\S.*?\S{0,1})\1/g,"$2").replace(/(`{3,})(.*?)\1/gm,"$2").replace(/`(.+?)`/g,"$1").replace(/\n{2,}/g,"\n\n")}catch(a){return console.error(a),c}return a}</script><script>const contentIndex=new FlexSearch.Document({cache:!0,charset:"latin:extra",optimize:!0,worker:!0,document:{index:[{field:"content",tokenize:"strict",context:{resolution:5,depth:3,bidirectional:!0},suggest:!0},{field:"title",tokenize:"forward"}]}}),scrapedContent={"/":{content:"# 🌱 Shihyu's PKM\n\n## Hi there 👋\n\nI'm Shihyu! I'm a Java Programmer in Taiwan - 🇹🇼.\n\n- ✉️ Mail - [methodho@gmail.com](mailto:methodho@gmail.com) \n- 👤 GitHub - [https://github.com/shihyuho/](https://github.com/shihyuho/)\n\n## Get Started\n\n👉 Let's [enter the forest](+home.md).\n",title:"Untitled Page"},"/+home":{content:"## Main Maps\n\n- [Umani MOC](moc/umani-moc.md)\n- [DDD MOC](moc/ddd-moc.md)\n- [Event Sourcing MOC](moc/event-sourcing-moc.md)\n- [Kubernetes MOC](moc/kubernetes-moc.md)\n- [Spring MOC](moc/spring-moc.md)\n## Private Stuff\n\n[Projects MOC](private/projects/projects-moc.md)\n\n\u003e Private pages doesn't get published!",title:"Home"},"/moc/ddd-moc":{content:"# DDD MOC\n\n- [Strategic Design](spaces/ddd/strategic-design.md)\n- [Tactical Design](spaces/ddd/tactical-design.md)",title:"Untitled Page"},"/moc/event-sourcing-moc":{content:"# Event Sourcing MOC\n\nEvent Sourcing 一定來自於 [DDD](moc/ddd-moc.md), 簡單來說:\n\n- Start with your [Domain](spaces/ddd/domain-modeling.md)\n- Find the [Bounded Context](spaces/ddd/bounded-context.md)\n- Find the Important Concepts\n- Find the Dynamics in your Business Language\n\n## Topics\n- [General Understanding](spaces/event-sourcing/general-understanding.md)\n- [You may NOT need a read model](spaces/event-sourcing/you-may-not-need-a-read-model.md)\n- [Guarantee Correctness when writing](spaces/event-sourcing/guarantee-correctness-when-writing.md)\n- [Handle Versioning](spaces/event-sourcing/handle-versioning.md)\n- [Create a Snapshot of the Stream](spaces/event-sourcing/create-a-snapshot-of-the-stream.md)\n- [Re-Model Domain](spaces/event-sourcing/remodel-domain.md)\n- [Dealing with Errors](spaces/event-sourcing/dealing-with-errors.md)\n## Reference\n\n特別感謝以下所有 Link, 本 MOC 中的內容都是從其中所節錄出來, 再加上少部分自己的心得整理而成\n\n- [Event Sourcing You are doing it wrong by David Schmitz](https://www.youtube.com/watch?v=GzrZworHpIk)\n- [Q\u0026A: Messaging, CQRS \u0026 Event Sourcing!](https://www.youtube.com/watch?v=05i9eyWl9Mk)",title:"Untitled Page"},"/moc/kubernetes-moc":{content:"# Kubernetes MOC\n\n- [Assigning Pods](spaces/kubernetes/assigning-pods.md)",title:"Untitled Page"},"/moc/showcase":{content:"Want to see what Quartz can do? Here are some cool community gardens :)\n\n- [Quartz Documentation (this site!)](https://quartz.jzhao.xyz/)\n- [Strengthening Online Social Bonds: Research Garden](https://communities.digital/)\n- [Jacky Zhao's Garden](https://garden.jzhao.xyz/)\n- [Anson Yu's Garden](http://garden.ansonyu.me/)\n- [Shihyu's PKM](https://shihyuho.github.io/pkm/)\n- [Chloe's Garden](https://garden.chloeabrasada.online/)\n- [SlRvb's Site](https://slrvb.github.io/Site/)\n- [Course notes for Information Technology Advanced Theory](https://a2itnotes.github.io/quartz/)\n\nIf you want to see your own on here, submit a [Pull Request adding yourself to this file](https://github.com/jackyzha0/quartz/blob/hugo/content/moc/showcase.md)!",title:"Showcase"},"/moc/spring-moc":{content:"# Spring MOC\n\n- [Externalized Configuration](spaces/spring/externalized-configuration.md)",title:"Untitled Page"},"/moc/umani-moc":{content:'# Umani MOC\n\n\u003e  "Umami" are: Sweetness, Sourness, Saltiness, Bitterness, and that oddball Umami. It\'s a mixture of insights and ideas, concepts and connections, all mingling together to create that mysterious full mouthfeel that magnificently completes any meal for the mind.\n\n\n- [Rime Input Method Engine](spaces/umani/Rime-Input-Method-Engine.md)\n- [Change Data Capture](spaces/umani/cdc.md)\n- [[spaces/umani/keeping-your-fork-update-to-date]]',title:"Untitled Page"},"/notes/hosting":{content:"---\n\n## GitHub Pages\nQuartz is designed to be effortless to deploy. If you forked and cloned Quartz directly from the repository, everything should already be good to go! You can head to `\u003cYOUR-GITHUB-USERNAME.github.io/quartz` to see it live.\n\n### Enable GitHub Actions\nBy default, GitHub disables workflows from running automatically on Forked Repostories. Head to the 'Actions' tab of your forked repository and Enable Workflows to setup deploying your Quartz site!\n\n![Enable GitHub Actions](/notes/images/github-actions.png)*Enable GitHub Actions*\n\n### Enable GitHub Pages\n\nHead to the 'Settings' tab of your forked repository and go to the 'Pages' tab.\n\n1. Set the source to deploy from `master` using `/ (root)`\n2. Set a custom domain here if you have one!\n\n![Enable GitHub Pages](/notes/images/github-pages.png)*Enable GitHub Pages*\n\n### Pushing Changes\nTo see your changes on the internet, we need to push it them to GitHub. Quartz is essentially a `git` repository so updating it is the same workflow as you would follow as normal.\n\n```shell\n# Navigate to Quartz folder\ncd \u003cpath-to-quartz\u003e\n\n# Commit all changes\ngit add .\ngit commit -m \"message describing changes\"\n\n# Push to GitHub to update site\ngit push origin hugo\n```\n\n### Setting up the Site\nNow let's get this site up and running. Never hosted a site before? No problem. Have a fancy custom domain you already own or want to subdomain your Quartz? That's easy too.\n\nHere, we take advantage of GitHub's free page hosting to deploy our site. Change `baseURL` in `/config.toml`. If you don't have a custom domain to use, you can use `\u003cYOUR-USERNAME\u003e.github.io` (which GitHub gives to you for free!) as your domain.\n\n[Reference.](https://github.com/jackyzha0/quartz/blob/hugo/config.toml)\n\n```toml\nbaseURL = \"https://\u003cYOUR-DOMAIN\u003e/\"\n```\n\nChange `cname` in `/.github/workflows/deploy.yaml`. Again, if you don't have a custom domain to use, you can use `\u003cYOUR-USERNAME\u003e.github.io`.\n\n[Reference.](https://github.com/jackyzha0/quartz/blob/hugo/.github/workflows/deploy.yaml)\n\n```yaml\n- name: Deploy  \n  uses: peaceiris/actions-gh-pages@v3  \n  with:  \n	github_token: ${{ secrets.GITHUB_TOKEN }} # this can stay as is, GitHub fills this in for us!\n	publish_dir: ./public  \n	publish_branch: master\n	cname: \u003cYOUR-DOMAIN\u003e\n```\n\n### Registrar\nThis step is only applicable if you are using a **custom domain**! If you are using `\u003cYOUR-USERNAME\u003e.github.io`, you can skip this step.\n\nFor this last bit to take effect, you also need to create a CNAME record with the DNS provider you register your domain with (i.e. NameCheap, Google Domains).\n\nGitHub has some [documentation on this](https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site), but the tldr; is to\n\n1. Go to your forked repository (`github.com/\u003cYOUR-GITHUB-USERNAME\u003e/quartz`) settings page and go to the Pages tab. Under \"Custom domain\", type your custom domain, then click **Save**.\n2. Go to your DNS Provider and create a CNAME record that points from your domain to `\u003cYOUR-GITHUB-USERNAME.github.io.` (yes, with the trailing period).\n\n	![Example Configuration for Quartz](/notes/images/google-domains.png)*Example Configuration for Quartz*\n3. Wait 30 minutes to an hour for the network changes to kick in.\n4. Done!\n\n## External Hosting\nDon't want to use GitHub Pages? Hugo builds everything for you! Everything is a packaged set of static files ready to deploy in `/public`. You can then upload this folder to a cloud provider to deploy. Alternatively, most providers also give users the option to link a GitHub repository and a folder to deploy. When doing this, ensure you select `/public` folder under the `master` branch.",title:"Deploying Quartz to the Web"},"/notes/ignore-notes":{content:'---\n\n### Quartz Ignore\nEdit `ignoreFiles` in `config.toml` to include paths you\'d like to exclude from being rendered.\n\n```toml\n...\nignoreFiles = [  \n    "/content/templates/*",  \n    "/content/private/*", \n    "\u003cyour path here\u003e"\n]\n```\n\n`ignoreFiles` supports the use of Regular Expressions (RegEx) so you can ignore patterns as well (e.g. ignoring all `.png`s by doing `\\\\.png$`).\nTo ignore a specific file, you can also add the tag `draft: true` to the frontmatter of a note.\n\n```markdown',title:"Ignoring Notes"},"/notes/philosophy":{content:"\u003e “[One] who works with the door open gets all kinds of interruptions, but [they] also occasionally gets clues as to what the world is and what might be important.” — Richard Hamming\n\n## Why Quartz?\nHosting a public digital garden isn't easy. There are an overwhelming number of tutorials, resources, and guides for tools like [Notion](https://www.notion.so/), [Roam](https://roamresearch.com/), and [Obsidian](https://obsidian.md/), yet none of them have super easy to use *free* tools to publish that garden to the world.\n\nI've personally found that\n1. It's nice to access notes from anywhere\n2. Having a public digital garden invites open conversations\n3. It makes keeping personal notes and knowledge *playful and fun*\n\nI was really inspired by [Bianca](https://garden.bianca.digital/) and [Joel](https://joelhooks.com/digital-garden)'s digital gardens and wanted to try making my own.\n\n**The goal of Quartz is to make hosting your own public digital garden free and simple.** You don't even need your own website. Quartz does all of that for you and gives your own little corner of the internet.",title:"Quartz Philosophy"},"/notes/preview-changes":{content:"If you'd like to preview what your Quartz site looks like before deploying it to the internet, here's exactly how to do that!\n\n## Install `hugo-obsidian`\nThis step will generate the list of backlinks for Hugo to parse. Ensure you have [Go](https://golang.org/doc/install) (\u003e= 1.16) installed.\n\n```shell\n# Install and link `hugo-obsidian` locally\n$ go install github.com/jackyzha0/hugo-obsidian\n\n# Navigate to your local Quartz folder\n$ cd \u003clocation-of-your-local-quartz\u003e\n\n# Scrape all links in your Quartz folder and generate info for Quartz\n$ hugo-obsidian -input=content -output=data -index=true\n```\n\nAfterwards, start the Hugo server as shown above and your local backlinks and interactive graph should be populated!\n\n##  Installing Hugo\nHugo is the static site generator that powers Quartz. If you'd like to preview your site locally, [install Hugo](https://gohugo.io/getting-started/installing/).\n\n```\n# Navigate to your local Quartz folder\n$ cd \u003clocation-of-your-local-quartz\u003e\n\n# Start local server\n$ hugo server\n\n# View your site in a browser at http://localhost:1313/\n```",title:"Preview Changes"},"/notes/troubleshooting":{content:"## Common Pitfalls\n### Can I publish only a subset of my pages?\nYes! Quartz makes selective publishing really easy. Heres a guide on [excluding pages from being published](notes/ignore-notes.md).\n\n### Can I host this myself and not on GitHub Pages?\nYes! All built files can be found under `/public` in the `master` branch. More details under [hosting](notes/hosting.md).\n\n### Do I need a website already?\nNo! Setting up Quartz means you set up a site too :)\n\n### `command not found: hugo-obsidian`\nMake sure you set your `GOPATH` correctly! This will allow your terminal to correctly recognize `hugo-obsidian` as an executable.\n\n```shell\n# Add the following 2 lines to your ~/.bash_profile\nexport GOPATH=/Users/$USER/go\nexport PATH=$GOPATH/bin:$PATH\n\n# In your current terminal, to reload the session\nsource ~/.bash_profile\n```\n\n### How come my notes aren't being rendered?\nYou probably forgot to include front matter in your Markdown files. You can either setup [Obsidian](notes/obsidian) to do this for you or you need to manually define it. More details in [the 'how to edit' guide](notes/editing.md).\n\n### My custom domain isn't working!\nWalk through the steps in [the hosting guide](notes/hosting.md) again. Make sure you wait 30 min to 1 hour for changes to take effect.\n\n### How do I setup Google Analytics?\nYou can edit it in `config.toml` and either use a V3 (UA-) or V4 (G-) tag.\n\n### How do I change the content on the home page?\nTo edit the main home page, open `/content/_index.md`.\n\n### How do I change the colours?\nYou can change the theme by editing `assets/custom.scss`. More details on customization and themeing can be found in the [customization guide](notes/config.md).\n\n### How do I add images?\nYou can put images anywhere in the `/content` folder. The only caveat is that you should reference them in your Markdown by prefixing it with a `/`.\n\n```markdown\nExample image (source is in content/notes/images/example.png)\n![Example Image](/content/notes/images/example.png)\n```\n\n### My Interactive Graph and Backlinks aren't up to date\nBy default, the `linkIndex.yaml` (which Quartz needs to generate the Interactive Graph and Backlinks) are not regenerated locally. To set that up, see the guide on [local editing](notes/editing.md)\n\n### Can I use React/Vue/some other framework?\nNot out of the box. You could probably make it work by editing `/layouts/_default/single.html` but that's not what Quartz is designed to work with. 99% of things you are trying to do with those frameworks you can accomplish perfectly fine using just vanilla HTML/CSS/JS.\n\n## Still Stuck?\nQuartz isn't perfect! If you're still having troubles, file an issue in the GitHub repo with as much information as you can reasonably provide. Alternatively, you can message me on [Twitter](https://twitter.com/_jzhao) and I'll try to get back to you as soon as I can.\n\n🐛 [Submit an Issue](https://github.com/jackyzha0/quartz/issues)",title:"Troubleshooting and FAQ"},"/spaces/+incubation/":{content:"# Incubation\n\nItems not yet ready for planting in need of planting.",title:"Untitled Page"},"/spaces/ddd/aggregate":{content:"# Aggregate\n\n- 包含了 Entities 跟 ValueObject\n- 負責所有 Entites 跟 ValueObject 的 [Invariants](spaces/ddd/invariants.md)\n- Aggregate 即 Transaction Boundary, \n- 建議一個 Aggregate 應該只對應一個 [Repository](spaces/ddd/repository.md), 並在該 Repository 綁上 Transaction\n- 使用名詞, 不要出現動詞\n- 避免使用不精確的名詞\n\n ## Interaction with other aggregate \n 如果是要協調調度兩個不同的聚合的情況下，一般我們會考慮是以 Application Service 來處理，或者是通過派發領域事件去跟另一個聚合做交互， domain service 還是比較隸屬於該聚合相關的業務話題的事物居多。\n\n \n ## Aggregate Root\n \n挑選 Aggregate 中的其中一個 Entity 最為 Root (根), 只有 Aggregate Root 持有整體的領域事件 (Domain Event)，並且決定何時發出去。\n\n\u003e 一個 Aggregate Root擁有 domain event list 就好像是一個汽車修理員隨身攜帶螺絲起子一樣是很自然的事情",title:"Untitled Page"},"/spaces/ddd/bounded-context":{content:"# Bounded Context\n- 盡可能的具象化\n- 等於是 Aggregate 的群組\n\n## Dealing with Relationships\n\n找出各個 Bounded Context 的上下文\n- **U**: Upstream 上文\n- **D**: Downstream 下文\n\n如果找到上下文之間有 cycle 關係, 代表這些參與 cycle 的 bounded context 的關係有問題, 有可能其實是同一個",title:"Untitled Page"},"/spaces/ddd/bridge-pattern":{content:"# Bridge Pattern\n\n橋接模式最主要就是將你的物件切分成概念與行為(殼與肉)，達到極致的解偶獨立，例如，遙控器他只是一個塑膠殼(概念)搭配一個電子電路版(行為)，如果我將電子電路版做成通用，以後遙控器的殼可以跟隨市場上流行的板式直接使用我的電子電路版。\n\n# Class Diagram\n\nAbstraction: 將原本的主體抽換到只剩下虛擬的概念，例如(人類:只是吃喝拉撒睡的主體、遙控器:只是開機關機調整的主體)\n\n## Class Diagram\n\n**RefineAbstraction:** 根據不同的需求實作主體\n\n**Implementator:** 將原本主體的實際功能抽離，成為這個的Hierarchy(繼承結構)，例如(人類:人類的吃和拉撒睡拉出在此結構實作)\n\n**ConcreteImplementator:** 根據不同的需求開發真實的行為\n\n![[spaces/ddd/attachments/bridge-pattern.png]]\n\n## Example\n\n在 Application 中我們定義 repository interface, 也就是 Bridge Pattern 的 **Abstraction**, 其中只會列出該 aggregate 中會用到的動作\n\n例如在 Balance Aggregate 中, 我們會使用到:\n- **getCurrentBalance:** 取得當前的餘額\n- **save:** 更新餘額\n\n```java\npacakge example.application.balance.repository;\n\n@FunctionInterface\ninterface BalanceRepository {\n    Balance getCurrentBalance();\n    void save(Balance balance);\n}\n```\n\n接的在 Infrastructure package 中去實作 Domain repository, 也就是 Bridge Pattern 的 **RefineAbstraction**, 這邊通常也是管理 Transaction 的地方, 而且這邊也不直接操作 Persistence framework (如 JPA), 取代代之的是傳入 Dao\n\n```java\npacakge example.infrastructure.repository.balance;\n\n@Repository\n@RequiredArgsConstructor\npublic class BalanceRepositoryImpl implements BalanceRepository {\n\n    final BalanceDao dao;\n    final BalanceMapper mapper; // Mapper mapping between PO (persistant object) and DO (domain object)\n\n    @Transactional(readOnly = true)\n    @Override  \n    public Balance getCurrentBalance() {  \n        return mapper.mapping(dao.findTopByOrderByIdDesc());\n    }  \n    \n    @Transactional(rollbackFor = Exception.class)\n    @Override  \n    public void save(Balance balance) {  \n        dao.save(mapper.mapping(balance));  \n    }  \n}\n```\n\n最後實作 Bridge Pattern 的 **Implementator**, 在下面範例中也就是 JPA 的實作:\n\n```java\npacakge example.infrastructure.balance.jpa;\n\npublic interface BalanceDao extends JpaRepository\u003cBalancePO, Long\u003e {\n    BalancePO findTopByOrderByIdDesc();\n}\n```\n\n如果未來要把 JPA 換成 Hibernate, 甚至 MongoDB, 我們都只需要換 **BalanceDao** 實作即可",title:"Untitled Page"},"/spaces/ddd/command":{content:"# Command\n\n通常是 Event 的倒裝, 例如: Event 是**買了鞋子**, Command 就是 **買鞋**\n\n## 便利貼顏色\n- 使用藍色 \n",title:"Untitled Page"},"/spaces/ddd/domain-modeling":{content:"# Domain Modeling\n\n## Aggregate\n\nEvent Storming 的 Aggregate 實作後比較像 Domain Modeling 的界線, 通常會再分:\n- Aggregate Root\n- Entity\n- Value Object\n\n## Aggregate Root\n\n可以從生命週期來看, 當某一件事在某個時間點結束時, 相關的資料也會跟的消失, 就樣就適合當成 Root\n\n在 Root 中可以從 `public getter`, `private setter` 開始設計\n\n## 怎麼找出 VO 或 Entity\n\n先在 Event Storming 的 Aggregate 中, 試著找到所有相關的名詞, 使用紫色便條紙, 這可以是很細節\n\n在這些紫色便條紙中, 依序往下區分\n\n### Value Object\n\nDescriptive aspect of domain, 是一種描述, 肚量 domain 的性質\n\n- Immutable value\n- Non-identical life cycle concept\n\n### Entity\n\n- 在 Value Object 中, 有狀態, 生命週期的, 改成定義為 Entity\n- 定義 Entity Id, Id 基本上也是 Value Object, 就算只有一個欄位也是這樣建議\n\n#### Entity ID\n 可以是以下方式:\n - User Input\n - Programing",title:"Untitled Page"},"/spaces/ddd/event":{content:"# Event\n\n事件，也稱領域事件，即不可抹滅的事實, 使用過去式表達\n\n## 便利貼顏色\n- 使用橘色\n- 或使用紫色便利貼, 紫色代表一個長流程, 也就是橘色的集合\n\n## 事件捕捉\n\n透過 Event Storming 找出事件, 關鍵有：\n- 統一語言 ubiquitous language\n- 限界上下文 bounded context\n\n即在不同上下文之間, 講不同語言\n\n\u003e 改系統，一定要有 business wish/value/goal，否則失敗率極高\n",title:"Untitled Page"},"/spaces/ddd/example-mapping":{content:"# Example Mapping\n\n## Use Case\n\n在 Bounded Context 中, 試著找出很多 Use Case, 使用黃色便條紙寫上\n\n## Rule\n\n在黃色的 Use Case 中, 找出很多 Rule, 使用藍色的便條紙\n\n## Example\n\n- 從 Rule 中找出範例, 使用綠色便條紙\n- 範例應該包含 Use Case 的正反向流程 (成功/失敗)\n\n## Question\n\n過程中想到什麼問題, 列成紅色的便條紙\n\n## 希望得到\n\n- 發現並擴展問題域, 甚至找到新的 User Mapping\n- Acceptance Tests\n- Sharing Understanding\n\n## Gherkin\n\nhttps://cucumber.io/\n\n- **Given**: 前置條件設定 \n- **When**: 發生了一個事件, 通常可以就是 Command\n- **Then**: 預期結果\n- **And**: 多個 Given (前置條件) 的串接\n- **But**: 多個 Then (預期結果) 的串接\n- **Examples**: 定義變數\n\n",title:"Untitled Page"},"/spaces/ddd/invariants":{content:"# Invariants\n\n不變量, 並不是只不會改變, 而是指改變的結果是符合程式設計的假設與前提! 在 DDD 架構中, [Aggregate](spaces/ddd/aggregate.md) 需要負責其不變量\n\n## Enforcing Invariants with Aggregates\n\n當模型中的物件關係有複雜關聯時, 是很難的去確保其中部分物件變更時整體的一致性\n\n### Solution\n\n我們將 Entities 跟 ValueObject 聚合在一起形成 Aggregate 並定義 Aggregate 的邊界。選擇一個 Entity 作為 [Aggregate Root](spaces/ddd/aggregate.md#aggregate-root), 並且我們只在 Aggregate Root 中去存取 Aggregate 邊界內的物件。\n\n對外我們也只開放 Aggregate Root 的引用, 任何外部都不能繞過 Aggregate Root 直接的對其內部物件修改, 這種安排可以確保任何針對 Aggregate 裡面的物件以及 Aggregate 本身的狀態修改都不會違反不變量 (Invariants)\n\n",title:"Untitled Page"},"/spaces/ddd/repository":{content:"# Repository\n\n一個 [[spaces/ddd/aggregate]] 對應一個 Repository\n\n## 兩種類型\n\n依據 DDD 紅皮書的分析，Repository有兩種：\n- Collection-like\n- CRUD-like\n    \nMartin Follower PoEAA書中的repository是collection-like，但一般我們常用的是CRUD-like，需要額外呼叫save儲存aggregate。所以當你決定使用Repository pattern，你要決定使用哪一種風格的repository。\n\n## 的目\n\nRepository 的目的是要隔離領域物件(aggregate)與資料庫操作。\n\n從領域物件的角度來看 ，根本不需要知道 Repository 的實作, Ex: 有哪些\nEntity? 對應多少個 Data Object?\n\n## Pattern\n\n通常是分析到最後，才需要關心Repository的實作, 在 DDD 加上 Clean Architecture 的情況下, 實作套 [[spaces/ddd/bridge-pattern]] 通常就搞定了!\n\nRepository 原本就是一個介面，就算你針對某個實作版本不滿意，不管是效能還是其他原因，換 Repository 的實作即可。\n\n\u003e 當然沒事不會常常換，因為換掉之後後端的資料庫可能需要隨著改變。如果已經有production的資料在上面，會比較麻煩。",title:"Untitled Page"},"/spaces/ddd/strategic-design":{content:"# Strategic Design\n\u003e 戰略\n\n- [Event](spaces/ddd/event.md)\n- [Command](spaces/ddd/command.md)\n- User\n- Read Model\n- Third Party\n- [Aggregate](spaces/ddd/aggregate.md)\n- [Bounded Context](spaces/ddd/bounded-context.md)\n- [Subdomain](spaces/ddd/subdomain.md)\n\n## 執行順序\n\n1. 匡圈 DDD 範圍, 在發想時如果已知超過範圍, 可使用粉紅色表示, 其代表另一個複雜流程\n2. 定義 Command (藍色) 跟 User(黃色)\n3. 在 Command 跟 Event 之中找 Logic (黃色), 勢必會打破原本的橘, 紫色\n4. Aggregate 聚合所有便利貼\n5. 找 Bounded Context\n\n## Sticky Note\n\n- **橘色**: 已經發生的事實，不可改變，使用過去式\n- **紫色**: 大流程, 即橘色的群組\n- **粉紅**: Third/External Party\n- **黃色**: User/Role\n- **藍色**: Command",title:"Untitled Page"},"/spaces/ddd/subdomain":{content:"# Subdomain\n\nSubDomain 可分:\n- Generic Subdomain\n- Support Subdomain\n- Core Subdomain\n\n## Generic Subdomain\n\n輪子不用再造, 找其他現成軟體或其他廠商的 API, 如: email, sms, 加密等\n\n## Support Subdomain\n\n用來支撐 core 的 subdomain\n\n## Core Subdomain\n\n最關注的 domain, 通常是改造的目標\n",title:"Untitled Page"},"/spaces/ddd/tactical-design":{content:"# Tactical Design\n\n\u003e 戰術\n\n## 提高系統存活率\n- Living Document - 讓文件語言跟程式語言儘量一至\n- Bubble - 讓一些還沒有要疏離的系統, \n- Infrastructure - CICD, Auto test\n- Architecture - \n\n## Re-modular \nModule in Monolith first\n\n\n## Core Domain Pattern\n\nX軸: Model Complicity\nY軸: Business Differentiation\n\n- Table stakes former core\n- Short-term core\n- Hidden core\n- Black swan core\n\n## ArchUnit\n\n測試程式依賴的工具\nhttps://www.archunit.org/use-cases\n\n## 資料結構\n\n- maven submodule: bounded context\n- aggregate 放 domain 中\n\n[Domain Modeling](spaces/ddd/domain-modeling.md)\n[Example Mapping](spaces/ddd/example-mapping.md)\n",title:"Untitled Page"},"/spaces/event-sourcing/aggregate-business-invariants":{content:" # Aggregate Business Invariants\n\n首先 Aggregate 應負責其邊界內的 [Invariants](spaces/ddd/invariants.md), 再來 Aggregate 本身也應該是 Transaction Boundary, 因此 Aggregate 必須也可以保證在多個 transactions 下的正確性。\n\n透過 [Optimistic Concurrency Control](spaces/umani/optimistic-concurrency-control.md) 我們可以確保在多個 Transactions 下都可以**依照順序的**執行完成, 且不會互相影響, 簡單來就是說每個 Transaction 都需要確認資料沒有被其他的 Trnasaction 異動過。\n\n## Last Event Number\n\n從 Stream 建立出 Aggregate 時, 必須記住 last event number, 在將新的 event 放入 Stream 前, 必須檢查當前的 Stream 的 event number\n\n![](/spaces/event-sourcing/attachments/occ-last-event-number.png)\n\n當 event number 一樣時代表沒有其他 Transaction 有增加 event, 這時我們才可以寫入新的 event\n\n![](/spaces/event-sourcing/attachments/occ-add-new-event.png)\n\n反之當不一樣時, 就不能寫入新的 event 進 Stream\n\n### Source Code Example\n\n![](/spaces/event-sourcing/attachments/ooc-source-code.png)\n\n## Kafka\n\n也許 Kafka offset 也可以用, 但可能要確認一下 Kafka 是否已經支援了",title:"Untitled Page"},"/spaces/event-sourcing/copy-transform":{content:"# Copy Transform\n\n首先先定義多久要 Transform 一次, 例如我們每年做一次, 這樣我們會在前一年的最後增加 Deactivated event, 並再次年增加一個 Initialized event, 並將兩個 event 連接起來\n\n![](/spaces/event-sourcing/attachments/copy-transform.png)\n\n- 這兩個基本上是不同的 Stream \n- 對應 Queue, 會是不同的 Kafak topic\n\n因此 App 在讀取到 Deactivated event 該怎麼自動切換到所連接的 Initialized event 的 Stream 呢?\n\n\u003e 這邊大概是最精華所在, 講解也沒透露他們怎麼做, 但如果可以重啟 App 來做切換那會簡單很多",title:"Untitled Page"},"/spaces/event-sourcing/create-a-snapshot-of-the-stream":{content:"# Create a Snapshot of the Stream\n\n時間一久當 Stream 越來越大以後, 程式該如何應對 Large Stream 呢? 基本上我們的程式不處理 Large Stream!\n\n而是我們透過 [Copy Transform](spaces/event-sourcing/copy-transform.md) 方式來建立 Strea 的 Snapshot, 來讓程式維持讀取 Small Stream!",title:"Untitled Page"},"/spaces/event-sourcing/dealing-with-errors":{content:"# Dealing with Errors\n\n假設過去有一個 Event 的內容發生問題, 該如何處理呢? 千萬不可以直接 update event store, 畢竟 event store 為 [Single Source of Truth](spaces/umani/single-source-of-truth.md), 既然是事實怎麼可以修改?\n\n## Use Compensation Events\n\n我們透過補償事件來處理錯誤\n\n### Partial Compensation\n\n透過 **Corrected Event** 來修正過去的**部分**錯誤, 例如我們想把 `Euro` 文字改成 `EUR`:\n\n![](/spaces/event-sourcing/attachments/partial-compensation.png)\n\n這個模式時間久了, 在回顧部分 Stream 時不容易的去了解前因後果, 而是必須還要查看完整的 Stream 才知道原因\n\n### Full Compensation\n\n透過 **Cancelled Event** 來完整的取消過去的錯誤, 情境一樣我們只想把 `Euro` 文字改成 `EUR`, 但這次是取消之前的錯誤 event:\n\n![](/spaces/event-sourcing/attachments/full-compensation.png)\n\n這個模式下, 以 Stream 的角度來看是比較明確的且比較清楚的\n",title:"Untitled Page"},"/spaces/event-sourcing/double-write":{content:"# Double Write\n\nProducer 將兩個版本的 event 都發佈, 而我們預期 Consumer 應該要可以自己判斷該處理哪個版本的 event\n\n![](/spaces/event-sourcing/attachments/versino-double-write.png)",title:"Untitled Page"},"/spaces/event-sourcing/general-understanding":{content:"# General Understanding \n\n![event-sourcing-flow](/spaces/event-sourcing/attachments/event-sourcing-flow.png)\n\n在經過 [DDD](moc/ddd-moc.md) 的洗禮之後, 我們會有很多 [Event](spaces/ddd/event.md), 包含了 Event type 跟 Data。我們會將這些 Event **有順序性**的儲存在 Stream 中 (通常就採用 Event 的建立順序)，然後再將這些 Stream 儲存到 EventStore 中, 並為每個 Event 產生獨一無二的 ID。\n\n接著我們會透過 [Projection](spaces/event-sourcing/projection.md) 將 Stream 中的所有 Events 去計算出 Aggregate 的 current state, 為了方便使用, 我們也可以將 current state 儲存成一個 [Read Model](spaces/event-sourcing/read-model.md)",title:"Untitled Page"},"/spaces/event-sourcing/guarantee-correctness-when-writing":{content:"# Guarantee Correctness when writing\n\n\u003e Validation against a read model is prone to **INCONSISTENCIES**\n\nRead Model 所提供的資訊, 同時有機會被多個服務或是 Thread 使用, 這時候就會造成一些不一致的問題!\n\n有個經典的提款情境: 兩個 Thread 在檢查同一帳戶餘額時都是通過的, 但一起下提款 Command 時, 你的帳戶就超支囉!\n\n![read-withdrawn](/spaces/event-sourcing/attachments/read-withdrawn.png)\n\n我們有使用兩個方式來解決這個問題\n\n- [Manage Transactions With a Database](spaces/event-sourcing/manage-transactions-with-database.md) \n- [Aggregate Business Invariants](spaces/event-sourcing/aggregate-business-invariants.md)\n\n## Reference\n\n- [Messaging as the Single Source of Truth](https://www.confluent.io/blog/messaging-single-source-truth/)",title:"Untitled Page"},"/spaces/event-sourcing/handle-versioning":{content:"# Handle Versioning\n\n在 Java 世界中, 我們通常透過 Jar 來 share source code, 假設現在是 1.0.0 jar 同時給 Producer 跟 Consumer 使用: \n\n![](/spaces/event-sourcing/attachments/version-v1.png)\n\n當 Producer 調整 event 開始發佈 2.0.0 時, 而所有的 Consumer 又還沒完全跟上時, 我們該怎麼辦?\n\n![](/spaces/event-sourcing/attachments/version-v2.png)\n\n## Solutions\n\n- [Double Write](spaces/event-sourcing/double-write.md)\n- [Upcaster](spaces/event-sourcing/upcaster.md)\n- Or... we don't upgrade event\n\n## Don't Upgrade event \n任何 Event schema 的異動都必須確保新的 schema 可以被舊的 handler 讀取使用，這樣你才可以異動之, 若不行, 它就是一個新的 Event, 你應該要有對應的新 handler!\n\n反之, 新的 handler 也應該要可以讀取處理舊的 schema, 若不行, 他也就是一個新的 Event, 你應該也要有對應的新 handler!\n\n\u003e 大部分情狀只有在增加欄位時才比較有機會相容於新舊 handler\n\n### Event Schema\n\n在 Event 中我們通常使用 Weak Schema (一般使用 [JSON Schema](spaces/umani/json-schema.md)), 就以新增欄位來說:\n\n任何舊版 handler 在 deserialized 時新的 schema 時, 因 week schema 特性會自動的忽略新欄位, 並正常的執行舊邏輯, 這不會有什麼問題。\n\n那如果是新的 handler 要處理舊的 schema 時, 就必須給予新欄位預設值跟邏輯, 這就好像在關聯式資料庫, 當我們要擴充欄位時, 也必須給予預設值讓程式正常的執行一樣, 當然, 如果你給不了預設值跟邏輯, 那它就是一個新的 event 了!\n\n ",title:"Untitled Page"},"/spaces/event-sourcing/manage-transactions-with-database":{content:"# Manage Transactions with a database\n\n這種狀況我們可以選擇在 Event Store 之前放一個 Database 去管理 Transaction\n\n我們使用一個 Database 擋在 Event Store 之前, 再使用 [CDC](spaces/umani/cdc.md) 抓取 Event Stream 到 Event Store 中, 在個 Database 即稱為 **Transaction Database**\n\n以下圖為例\n\n- Transaction Database 使用 Couchbase\n- Event Store 使用 Kafka\n\n![](https://cdn.confluent.io/wp-content/uploads/Screenshot-2017-08-02-08.39.55-1024x865.png)\n\n當 Order Service 接到 Bug Command 時, 寫的是 Couchbase, 在這邊管理多個 Order Service Instance 或多個 Thread 的 Transaction\n\n當 Couchbase 資料有變化時, 會被 CDC (Kafka connect) 發佈到 Kafka 中\n\n## Trafe Off\n\n這個方式要付出的大概就是, 你需要多維護一個 **Production Grage** 的 Database!",title:"Untitled Page"},"/spaces/event-sourcing/projection":{content:"# Projection\n\nProjection 就是用來處理 [event](spaces/ddd/event.md) 的程式邏輯, 基本上就是一推 Event Handlers!\n\n例, 我們有以下 event:\n- `UserCreated`\n- `UserOnboarded`\n- `UserRelocated` \n\n則 **Current User Projection** 的內容大概是:\n\n![projection](/spaces/event-sourcing/attachments/projection.png)\n\n而產出會是 [Aggregate](spaces/ddd/aggregate.md)\n\n![projection-aggregate](/spaces/event-sourcing/attachments/projection-aggregate.png)\n",title:"Untitled Page"},"/spaces/event-sourcing/read-model":{content:"# Read Model\n\nRead Model 可以說是在 Event Store 中, 特定的 Event of Stream 的產出。\n\n以程式來看, 大概像是:\n\n```java\nvar readModel = Stream.of(events)\n					  .leftFold(handlers)\n```\n\n這個產出, 通常也就是會被儲存在每個服務自己的 db 中 \n\n![readmodel](/spaces/event-sourcing/attachments/readmodel.png)",title:"Untitled Page"},"/spaces/event-sourcing/remodel-domain":{content:"# Re-Model Domain\n\n當我們需要 Re-Model Domain 時, 例如打散 event, 該怎麼做呢? 基本上跟 [Copy Transform](spaces/event-sourcing/copy-transform.md) 一樣概念:\n\n![](/spaces/event-sourcing/attachments/remodel-domain.png)",title:"Untitled Page"},"/spaces/event-sourcing/upcaster":{content:"# Upcaster\n\nUpcaster 通常擋在 Queue 跟 Consumer 之間, 它負責做事件版本的轉換\n\n![](/spaces/event-sourcing/attachments/upcaster.png)\n\n## Trafe off\n\n要注意的是, 當時間一久, 這種模式下 Upcaster 很容易的會失控跟維護, 因次他會有有大量的轉換邏輯在其中\n\n![](/spaces/event-sourcing/attachments/upcaster-chaos.png)",title:"Untitled Page"},"/spaces/event-sourcing/you-may-not-need-a-read-model":{content:"# You may NOT need a read model\n[Read Model](spaces/event-sourcing/read-model.md) 會有一些 Trade off:\n- 最終一致性\n- 該如何 Replays and Rebuilds\n- 該如何 Re-Deliveries\n- Read Db 的維運成本\n\n換個角度想, 如果不要有 Read Model 呢?\n\n我們如果在讀取 Event Store 時, 就依照 Aggregate ID 過濾 Stream, 把 Stream 最小化\n\n![stream-per-aggregate](/spaces/event-sourcing/attachments/stream-per-aggregate.png)\n\n回到使用端, 在 runtime 要取得 current state 時, 程式在即時的去運算出 current state 的 Aggregate\n\n![aggregate-read-from-stream](/spaces/event-sourcing/attachments/aggregate-read-from-stream.png)\n\n由於我們把 Stream 最小化了, 效能仍不錯, 而且也沒有了那些 Trade off!\n\n如果需要透過條件去查詢, 可能要使用到一些 Event Store 所提供 Category Projection 了!\n\n![aggregate-read-from-projection](/spaces/event-sourcing/attachments/aggregate-read-from-projection.png)\n\n在 Event Store 中就可以先將 Event 分類後再讀出 Stream 了!\n\n\u003e What if... 我們用的 event store 沒有 category projection ;\\",title:"Untitled Page"},"/spaces/kubernetes/assigning-pods":{content:'# Assigning Pods\n\n在部署 Deployment 時, 有些情況我們會希望 Kubernetes 依照我們的需求來安排部署的 Node, 例如:\n\n- 當我們開多份 Replicas 時, 希望這些 Replicas 時儘量不要安排到同一個 Node 上\n- 不同的部署但性質相雷同的程式, 例如資源需求 (如 CPU 運算) 較高等, 希望儘量不要安排到同一個 Node 上\n\n## Affinity\n\n在 `spec.affinity` 下一共有 `podAffinity` (正向) 或 `podAntiAffinity` (反向), 這是用來約束 Kubernetes 該怎麼安排 Pod 到 Node 上, 這兩種 affinity 中都有兩種 type 可以使用:\n\n- `requiredDuringSchedulingIgnoredDuringExecution` - **Hard requirement**, 要求 Kubernetes 依照設定安排, 沒滿足就不部署 Pod\n- `preferredDuringSchedulingIgnoredDuringExecution` - **Soft requirement**, 建議 Kubernetes 儘量滿足設定安排, 無法滿足仍要部署 Pod\n\n## Use Case\n\n\u003e 以下我們範例是一個常見的需求: **建議** Kubernetes 將多個 replicas 儘量分散到不同的 Node 中\n\n首先我們在 SLKE 中部署一個 deployment 作為範例, 先設定一個 replica 就好:\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: my-nginx\nspec:\n  selector:\n    matchLabels:\n      run: my-nginx\n  replicas: 1\n  template:\n    metadata:\n      labels:\n        run: my-nginx\n    spec:\n      affinity:\n        podAntiAffinity:\n          preferredDuringSchedulingIgnoredDuringExecution:\n            # 可設多條件, 其中 weight 範圍為 1-100\n            # 部署於 k8s 會將滿足條件的 weight 累加, 總分最高的 node 視為 most preferred \n            - weight: 1\n              podAffinityTerm:\n                labelSelector:\n                  matchExpressions:\n                  - key: run\n                    operator: In\n                    values:\n                      - my-nginx\n                # 設定 Node 分群的依據\n                # 可透過 kubectl get nodes --show-labels 查看有哪些 label 可用\n                topologyKey: "kubernetes.io/hostname"\n      containers:\n      - name: my-nginx\n        image: nginx\n        ports:\n        - containerPort: 80\n```\n\n以上設定會建議 Kubernetes 在部署時, 以 Node 的 `kubernetes.io/hostname` 做群組, 在每個群組中都儘量不重複部署 label 為 `run: my-nginx` 的 pod, 由於 Node `kubernetes.io/hostname` 不可能重複, 也就是上述設定以白話文來說, 一但開多個 replicas, 就是儘量將不同的 pod 分散在不同的 node 中\n\n接著我們查看一下現在 SLKE 有多少 Node:\n\n```sh\n$ kubectl get node\nNAME            STATUS   ROLES                  AGE    VERSION\nk8s-master-91   Ready    control-plane,master   161d   v1.20.1\nk8s-master-92   Ready    control-plane,master   161d   v1.20.1\nk8s-master-95   Ready    control-plane,master   161d   v1.20.1\nk8s-worker-40   Ready    \u003cnone\u003e                 161d   v1.20.1\nk8s-worker-41   Ready    \u003cnone\u003e                 161d   v1.20.1\nk8s-worker-44   Ready    \u003cnone\u003e                 161d   v1.20.1\nk8s-worker-46   Ready    \u003cnone\u003e                 161d   v1.20.1\nk8s-worker-53   Ready    \u003cnone\u003e                 161d   v1.20.1\n```\n\n以上會發現 worker node (未標記 control-plane 的 node 即 worker node) 一共有 5 台, 因此我們在對剛剛部署的 deployment 做些調整:\n\n```sh\n$ kubectl scale --replicas=5 deployment my-nginx\n```\n\n最後觀察 pod 所開的 node, 會發現所有的 pod 都開在不同的 Node `kubernetes.io/hostname` 上\n\n```sh\n$ kubectl get pod -l run=my-nginx -o wide\nNAME                       READY   STATUS    RESTARTS   AGE   IP              NODE            NOMINATED NODE   READINESS GATES\nmy-nginx-fc5f9bc4b-229mt   2/2     Running   0          41s   10.244.21.92    k8s-worker-40   \u003cnone\u003e           \u003cnone\u003e\nmy-nginx-fc5f9bc4b-66q7j   2/2     Running   0          41s   10.244.166.81   k8s-worker-53   \u003cnone\u003e           \u003cnone\u003e\nmy-nginx-fc5f9bc4b-k7jps   2/2     Running   0          20m   10.244.9.213    k8s-worker-44   \u003cnone\u003e           \u003cnone\u003e\nmy-nginx-fc5f9bc4b-m6vrz   2/2     Running   0          41s   10.244.253.98   k8s-worker-46   \u003cnone\u003e           \u003cnone\u003e\nmy-nginx-fc5f9bc4b-s5bk2   2/2     Running   0          42s   10.244.52.163   k8s-worker-41   \u003cnone\u003e           \u003cnone\u003e\n```\n\n## Reference\n\n- [Assigning Pods to Nodes](https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/)\n',title:"Untitled Page"},"/spaces/spring/externalized-configuration":{content:'\n# Externalized Configuration\n\nSpring Boot 2.4 改進了處理 `application.properties` 等設定檔的讀取的模式, 調整後的邏輯多支援了配置外部的載入方式, 此篇提供了一個簡單的 workshop 來介紹怎麼應用到雲平台 (Cloud Platform) 的部署上\n\n\u003e 如果是用 Spring Boot 2.4+ 但想要使用舊的邏輯, 可設定 `spring.config.use-legacy-processing=true`\n\n## Config Data File\n\nSpring Boot 在啟動時會參考許多設定來源 (Configuration Sources), Spring 也提供了[許多方式來配置](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.external-config), 這些源包含了以下常見的 (順序是重要的):\n\n- Config data file(如 `application.properties`)\n- OS environment variables\n- Java System properties (`System.getProperties()`).\n- Command-line arguments\n- Testing config\n- ... etc\n\n其中在讀取 Config data file 的階段順序如下：\n\n1. Application properties packaged inside your jar (`application.properties` and YAML variants).\n1. Profile-specific application properties packaged inside your jar (`application-{profile}.properties` and YAML variants).\n1. Application properties outside of your packaged jar (`application.properties` and YAML variants).\n1. Profile-specific application properties outside of your packaged jar (`application-{profile}.properties` and YAML variants).\n\n\n### External Application Properties\n\nSpring Boot 預設的載入目錄順序為:\n\n- `optional:classpath:/;optional:classpath:/config/`\n- `optional:file:./;optional:file:./config/;optional:file:./config/*/`\n\n你可以使用 `spring.config.location` 覆蓋預設載入行為:\n\n```properties\n# 覆蓋預設載入行為, 若為資料夾要以 \'/\' 結尾\nspring.config.location=optional:classpath:/custom-config/\n```\n\n或是使用 `spring.config.additional-location` 在預設載入行為之後增加額外的讀取路徑:\n\n```properties\nspring.config.additional-location=optional:classpath:/custom-config/\n```\n\n以上設定 Spring 在載入的時機點非常的早, 通常是在 OS environment variable, system property 或 command-line argument 就必須先決定, 因此在[配置上有許多限制, 且檔案格式的支援上也有所限制](https://spring.io/blog/2020/08/14/config-file-processing-in-spring-boot-2-4#importing-additional-configuration)。\n\n在雲平台 (Cloud Platform) 的部署上, 通常我們會在啟動 Container 時, 才將額外的設定以 Volume Mount 方式綁定到 Container 中, 因此在 Spring Boot 2.4 之後多了 `spring.config.import` , 可以在讀取到 properties 時才會再去載入所 import 的設定檔:\n\n```properties\nspring.application.name=myapp\nspring.config.import=optional:file:./dev.properties\n```\n\n`spring.config.import` 除了 properties 或 YAML 檔案格式以外, 還支援了更多其他的設定方式, 如: [Configuration Trees](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.external-config.files.configtree)\n\n### Profile Specific Files\n\nSpring Boot 2.4 之後在讀取 `application` properties 外, 也跟之前一樣會試著讀取 `application-{profile}` 檔案, 假設我們啟動了 `prod,live` profile , 則載入的順序如下 (檔案沒找到不會報錯):\n\n1. `application.properties`\n2. `application-prod.properties`\n3. `application-live.properties`\n\n當 `spring.config.location` 指定多個目錄/檔案時, 要注意:\n\n-  `,` - 使用逗號分隔多個目錄/檔案，且**有載入順序**的概念\n-  `;` - 使用分號分隔多個目錄/檔案, 是沒有順序的建議，所有目錄/檔案都會被視為同一等級。\n\n\u003e 點擊參考[官方範例說明](https://docs.spring.io/spring-boot/docs/current/reference/html/features.html#features.external-config.files.profile-specific)\n\n當設定檔被 Spring 載入後, 會被放入 `Map` 結構的物件中, 若同樣的 key 重複載入時, 其 value 將會被更新, 即後蓋前。換句話說, **載入順序越後面的設定將會最終被採用**\n\n## Prepare Application\n\n首先我們要準備一個 Spring Boot 2.4+ 的 Application, 請到 [Spring Initializr](https://start.spring.io/) 下載一個全新的專, Spring Boot 版本選擇 **2.4+**, Dependencies 選擇 **Spring Web**, 或是執行以下指令取得:\n\n```bash\n$ curl https://start.spring.io/starter.zip \\\n		-d bootVersion=2.4.3 -d dependencies=web \\\n		-o demo.zip\n$ unzip demo.zip\n```\n\n在 main class 的 package 中, 加上以下 Java class\n\n```java\npackage com.example.demo;\n\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\npublic class AppNameController {\n\n  @GetMapping\n  public String name(@Value("${spring.application.name}") String appName) {\n    return "Hello " + appName;\n  }\n}\n```\n\n接著開啟專案中的 `application.properties`, 加上:\n\n```properties\n spring.application.name=MyApp\n```\n\n完成以上步驟後執行 main class 或透過 `mvn spring-boot:run`啟動 App, 接著輸入以下指令確認:\n\n```bash\n$ curl localhost:8080 \nHello MyApp\n```\n\n## Import Additional Config\n\n通常在雲平台中, 都有提供 volume mounted 功能將設定檔 mount 至 Container 中, 因此現在我們需要配置一個目錄給之後 mount config 用, 開啟 `application.properties` 加上\n\n```properties\nspring.config.import=optional:file:/tmp/config/\n```\n\n`spring.config.import` 可以指定檔案或目錄, 是用來告訴 Spring 在啟動時還要載入哪些 config\n\n建議可以使用目錄 (斜線 `/` 結尾) 的方式來配置, 讓 Spring 還是依照他自己的載入順序來讀取目錄下的檔案, 這樣可以保留多一點配置的彈性給未來各種雲平台的部署檔\n\n避免在 Container 中遭遇檔案讀取權限的問題, 建議可以將目錄配置在 `/tmp` 下\n\n### Test Locally\n\n在你的電腦建立 `/tmp/config/application.yaml`, 內容為:\n\n```yaml\nspring:\n  application:\n    name: MyLocalApp\n```\n\n接著重新啟動 App, 再透過原本的指令我們會發現輸出變了\n\n```bash\n$ curl localhost:8080\nHello MyLocalApp\n```\n\n## Build Image\n\n我們透過以下指令建置 Image, 用來準備部署到雲平台使用! \n\n```bash\nmvn spring-boot:build-image\n```\n\n預設的 Image 名稱是 maven 的 `{project.artifactId}:{project.version}`, 也就是 `demo:0.0.1-SNAPSHOT`\n\n若覺得不適用可以透過參數 `spring-boot.build-image.imageName` 指定名稱, 你可以在 `pom.xml` 的 `\u003cproperties/\u003e` 中加上或透過 command line 傳入, 如:\n\n```bash\nmvn spring-boot:build-image -Dspring-boot.build-image.imageName=demo:1.0.0\n```\n\n## Deploy Cloud Platform\n\n在章節中我們會以兩個常見雲平台作為範例: **Docker Swarm** 及 **Kubernetes**\n\n### Docker Swarm\n\n準備以下檔案並放在同樣的目錄下:\n\n```bash\n.\n├── application.yaml\n└── docker-compose.yml\n```\n\n```yaml\nversion: "3.8"\nservices:\n  demo:\n    image: demo:1.0.0\n    ports:\n      - 8080:8080\n    configs:\n      - source: demo-config\n        target: /tmp/config/application.yaml\nconfigs:\n  demo-config:\n    file: ./application.yaml\n```\n\n```yaml\nspring:\n  application:\n    name: MySwarmApp\n```\n\n接著透過以下指令部署\n\n```yaml\ndocker stack deploy demo -c docker-compose.yml\n# docker stack remove demo\n```\n\n服務啟動後, 再透過原本的指令我們會發現輸出又變了\n\n```bash\n$ curl localhost:8080\nHello MySwarmApp\n```\n\n### Kubernetes\n\n準備以下檔案並放在同樣的目錄下:\n\n```yaml\n.\n├── configmap.yaml\n└── deployment.yaml\n```\n\n```yaml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: demo\n  labels:\n    app: demo\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: demo\n  template:\n    metadata:\n      labels:\n        app: demo\n    spec:\n      containers:\n      - name: demo\n        image: demo:1.0.0\n        resources:\n          limits:\n            cpu: 2\n            memory: 1Gi\n          requests:\n            cpu: 1\n            memory: 500Mi\n        ports:\n        - containerPort: 8080\n        volumeMounts:\n        - name: config-volume\n          mountPath: /tmp/config\n      volumes:\n      - name: config-volume\n        configMap:\n          name: demo-config\n```\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: demo-config\ndata:\n  application.yaml: |-\n    spring:\n      application:\n        name: MyKubernetesApp\n```\n\n接著透過以下指令部署\n\n```yaml\nkubectl apply -f .\n# kubectl delete -f .\n```\n\n服務啟動後, 透過 port-forward 設定 port mapping:\n\n```bash\nkubectl port-forward deploy/demo 8080\n```\n\n再透過原本的指令我們會發現輸出又變了\n\n```bash\n$ curl localhost:8080\nHello MyKubernetesApp\n```\n\n## Good Old  Days\n\n之前, 我們會針對可能會依照環境不同有變動的設定, 提前挖洞給 configmap 來填, 例如:\n\n```yaml\nspring:\n  application:\n    name: ${APP_NAME:MyApp}\n```\n\n然後我們會在 configmap 配置這些挖好的洞, 在部署前先給客戶填寫:\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: demo-config\ndata:\n  APP_NAME: MyKubernetesApp\n```\n\n對開發人員來說, 需要挖洞的確比較麻煩, 像是:\n\n- 要挖新的洞總是要重新打包 Image\n- 洞挖多了維護 configmap 上也變複雜許多了\n- 需要想挖洞的 Key 名稱啊, 取名總是最花時間的!\n\n然而對於我們的客戶來說, 維運的窗口 (如過版人員) 挖洞其實有保障的, 如他們:\n\n- 不需要去了解 Spring Boot 要怎麼配置\n- 不用擔心配置結構錯了, 或 key 寫錯就輕易的影響 Runtime 行為, 甚至導致整個 App 開不起來\n\n想更遠一些, 如果要抽象化實作跟配置方式, 挖洞的方式甚至還更適合一些, 以維運團隊的角度來看, 在配置部署上本來就不需要去知道實作的, 甚至就算在未來換掉 Spring Boot 也是開發團隊的事情罷了!\n\n本篇介紹了新的 Spring 配置模式, 大家可以從中思考怎麼選擇或混用這些配置方式, 來建議客戶最佳的解決方案!\n',title:"Untitled Page"},"/spaces/umani/Rime-Input-Method-Engine":{content:'# 中州韻輸入法引擎\n\n我是用注音輸入法，一直以來都使用 MacOS Big Sur 中的內建的注音輸入法，但真的越來越慢，慢到真的受不了了...\n\n找個時間收尋並且嘗試了一下其他支援 MacOS 中的注音輸入法, 包含了\n\n- [Yahoo輸入法](https://github.com/zonble/ykk_installer)\n- [小麥輸入法](https://mcbopomofo.openvanilla.org/)\n- [超注音](http://www.superkbd.com/)\n- [中州韻輸入法引擎](https://rime.im/)\n\n其中**中州韻輸入法引擎**最吸引我的眼球，效能好，設定方式很工程師(誤)，本身開源，GitHub 上一直都有持續的維護更新等等，都很符合我的口味！\n\n因此此篇稍微記錄一下安裝跟配置方式，提供日後 OS 重裝後的參考\n\n## Install\n\n可以從官方 [Downlaod Page](https://rime.im/download/) 下載安裝檔，或使用 [Homebrew](https://brew.sh/) 來安裝:\n\n```sh\nbrew install --cask squirrel\n```\n\n## Setup\n\n安裝好後, 所有相關的配置可以從 menu 中的輸入法中進入, 更改配置後都需要重新點擊 **Deploy** 始得生效\n\n![](/spaces/umani/attachments/rime-input.png)\n\n### Custom Settings\n\n點選 **Settings**, 會開啟 Rime 的目錄, MacOS 預設目錄在:\n\n```sh\n/Users/{username}/Library/Rime\n```\n\n在該錄中建立 `default.custom.yaml` 檔案\n\n```sh\ntouch /Users/{username}/Library/Rime/default.custom.yaml\n```\n\n`default.custom.yaml` 是用來覆蓋全域性的配置檔案, 你只需要把想要調整的設定項目放在 `patch` 下, 如:\n\n```yaml\npatch:\n  some_setting: "some value"\n  yet:\n    another_setting: 0\n```\n\n可以調整的設定項目可參考官方的[CustomizationGuide](https://github.com/rime/home/wiki/CustomizationGuide) 或[完整的注音輸入 Schema](https://gist.github.com/lotem/3913578)\n\n### My Settings\n\n以下列出我目前的配置:\n\n```yaml\n# default.custom.yaml\n\npatch:\n  menu:\n    page_size: 7  # 每頁顯示的選項數目\n  key_binder:\n    bindings:\n      # 在 Rime 中加入"["和"]"翻頁按键绑定\n      - { when: paging, accept: bracketleft, send: Page_Up }\n      - { when: has_menu, accept: bracketright, send: Page_Down }\n  schema_list:  # 按 F4 選擇輸入法出現的項目\n    - schema: bopomofo  # 注音, 因為我只用注音囉\n```\n\n\u003e schema_list 可參考 https://gist.github.com/mitnk/3401421\n\n我大概只設了這些，沒有使用 [Sync](https://github.com/rime/home/wiki/UserGuide#%E5%90%8C%E6%AD%A5%E7%94%A8%E6%88%B6%E8%B3%87%E6%96%99) 等功能, 剩餘的配置都是使用預設就很好用囉!\n\n## Uninstall\n參考官方 [FAQ](https://github.com/rime/home/wiki/FAQ#%E5%A6%82%E4%BD%95%E5%8D%B8%E8%BC%89%E9%BC%A0%E9%AC%9A%E7%AE%A1squirrel)\n## Reference\n- [GitHub](https://github.com/rime)\n- [Wiki](https://github.com/rime/home/wiki)\n	- [UserGuide](https://github.com/rime/home/wiki/UserGuide)\n	- [CustomizationGuide](https://github.com/rime/home/wiki/CustomizationGuide)\n- [開源好用的輸入法--鼠鬚管](https://intergroup.gitbook.io/080/yuan-hao-yong-de-ru-fa-shu-guan)',title:"Rime Input Method Engine"},"/spaces/umani/cdc":{content:"Change Data Capture 縮寫 CDC, 意指如何發現並捕獲資料源 (Source Database) 的資料變化, 常見的解決方案有:\n\n- Log-based\n- ETL\n- Trigger-based\n\n## Log-based\n\n![](/spaces/umani/attachments/cdc-log-based.png)\n\n透過工具監控 Source Database 的 Transaction Log, 常見的工具如: [Debezium](https://debezium.io/)\n\n### Challenges\n1. 需配合所挑選的 Tool 的相關設定, 如 Debezium 官方[所要求的權限](https://debezium.io/documentation/reference/connectors/oracle.html#setting-up-oracle) 可能客戶的 DBA 會認爲過大\n2. 部分 Database 需要配合設定, 如 Oracle 需要啓用 Archive Log, 若客戶本身沒使用這些功能, 則開啓後對客戶環境的穩定度是一個挑戰\n\n## ETL\n\n![](/spaces/umani/attachments/cdc-etl.png)\n\n透過約定好的 Audit Columns (如 `createdDate`, `lastModifiedDate`) 來進行 ETL\n\n實作一個 CDC App, 定期以 Audit Columns 作爲判斷依據來查詢 Source Database, 將捕捉到的異動資料同步到 Target Database 中\n\n### Challenges\n1. 要被監控的 Table 都必須要有 Audit Columns \n2. 人爲操作 DB 也必須都要更新 Audit Columns \n3. 視業務需求, 需要有額外的 Source Database 刪除資料的處理流程\n4. Source Database 會有額外的效能消耗給 CDC App 定期的查詢\n5. CDC App 定期查詢的週期決定了 Target Database 的資料時間差\n\n## Trigger-based\n\n![](/spaces/umani/attachments/cdc-trigger-based.png)\n\n透過在 Source Database 中設定 Database Trigger 來監控目標 Table\n\n當目標 Table 資料發生異動時會觸發 Trigger, Trigger 的內容是將資料異動內容寫入 Shadow Table\n\n實作一個 CDC App, 定期查詢 Shadow Table 將發現的異動內容同步到 Target Database 中\n\n\n### Challenges\n1. 需要 Database 有支援 Trigger\n2. 監控 Table 跟 Shadow Table 建議在同一個 Database Instance\n3. Source Database 會有額外的效能消耗給 Trigger\n4. CDC App 定期查詢的週期決定了 Target Database 的資料時間差",title:"Change Data Capture"},"/spaces/umani/json-schema":{content:"# JSON Schema\n\nJSON Schema 是一種宣告式語言, 可以定義並驗證 JSON 物件的結構, Java 套件可參考 [everit-org/json-schema](https://github.com/everit-org/json-schema.git)\n\n## Reference\n\n- [Introduction to JSON Schema in Java](https://www.baeldung.com/introduction-to-json-schema-in-java)",title:"Untitled Page"},"/spaces/umani/optimistic-concurrency-control":{content:"# Optimistic Concurrency Control\n\n樂觀鎖 (簡稱 OCC), 是一種並行控制的方法。\n\n簡單的實作方式就是, 找資料其中一個欄位作為判斷條件, 如 `@Version` 或是 `最後修改時間`, 在資料異動時將該欄位一併作為 Where 條件去執行, 若 `update row = 0` 即代表資料已過期。\n\n如此我們就可以確保同時多個 Transaction 針對同一筆資料異動的順序性, 不會發生後蓋前等狀況。",title:"Untitled Page"},"/spaces/umani/single-source-of-truth":{content:"# Single Source of Truth\n\n事實的唯一來源, 在系統設計與理論中, 事實的唯一來源是構建信息模型和關聯的數據模式的實踐, 一個 Application 應該只引用或參考自一個主要的事實的資料源",title:"Untitled Page"},"/templates/post":{content:"",title:"{{title}}"}};for(const[b,a]of Object.entries(scrapedContent))contentIndex.add({id:b,title:a.title,content:removeMarkdown(a.content)});const highlight=(i,j)=>{const a=20,k=j.split(/\s+/).filter(a=>a!==""),b=i.split(/\s+/).filter(a=>a!==""),f=a=>k.some(b=>a.toLowerCase().startsWith(b.toLowerCase())),d=b.map(f);let e=0,g=0;for(let b=0;b<Math.max(d.length-a,0);b++){const f=d.slice(b,b+a),c=f.reduce((a,b)=>a+b,0);c>=e&&(e=c,g=b)}const c=Math.max(g-a,0),h=Math.min(c+2*a,b.length),l=b.slice(c,h).map(a=>{return f(a)?`<span class="search-highlight">${a}</span>`:a}).join(" ").replaceAll('</span> <span class="search-highlight">'," ");return`${c===0?"":"..."}${l}${h===b.length?"":"..."}`},resultToHTML=({url:b,title:c,content:d,term:a})=>{const e=removeMarkdown(d),f=highlight(c,a),g=highlight(e,a);return`<button class="result-card" id="${b}">
        <h3>${f}</h3>
        <p>${g}</p>
    </button>`},redir=(a,b)=>{window.location.href="https://shihyuho.github.io/pkm/"+`${a}#:~:text=${encodeURIComponent(b)}`},fetch=a=>({id:a,url:a,title:scrapedContent[a].title,content:scrapedContent[a].content}),source=document.getElementById('search-bar'),results=document.getElementById("results-container");let term;source.addEventListener("keyup",a=>{if(a.key==="Enter"){const a=document.getElementsByClassName("result-card")[0];redir(a.id,term)}}),source.addEventListener('input',a=>{term=a.target.value,contentIndex.search(term,[{field:"content",limit:10,suggest:!0},{field:"title",limit:5}]).then(c=>{const a=b=>{const a=c.filter(a=>a.field===b);return a.length===0?[]:[...a[0].result]},d=[...a('title'),...a('content')],b=d.map(fetch);if(b.length===0)results.innerHTML=`<div class="result-card">
                    <p>No results.</p>
                </div>`;else{results.innerHTML=b.map(a=>resultToHTML({...a,term})).join("\n");const a=document.getElementsByClassName("result-card");[...a].forEach(a=>{a.onclick=()=>redir(a.id,term)})}})});const searchContainer=document.getElementById("search-container");function openSearch(){searchContainer.style.display==="none"||searchContainer.style.display===""?(source.value="",results.innerHTML="",searchContainer.style.display="block",source.focus()):searchContainer.style.display="none"}function closeSearch(){searchContainer.style.display="none"}document.addEventListener('keydown',a=>{a.key==="/"&&(a.preventDefault(),openSearch()),a.key==="Escape"&&(a.preventDefault(),closeSearch())}),window.addEventListener('DOMContentLoaded',()=>{const a=document.getElementById("search-icon");a.addEventListener('click',a=>{openSearch()}),a.addEventListener('keydown',a=>{openSearch()}),searchContainer.addEventListener('click',a=>{closeSearch()}),document.getElementById("search-space").addEventListener('click',a=>{a.stopPropagation()})})</script><div class=singlePage><header><svg tabindex="0" id="search-icon" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg><div class=spacer></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><aside class=mainTOC><h3>Table of Contents</h3><nav id=TableOfContents><ol><li><a href=#interaction-with-other-aggregate>Interaction with other aggregate</a></li><li><a href=#aggregate-root>Aggregate Root</a></li></ol></nav></aside><h1 id=aggregate>Aggregate</h1><ul><li>包含了 Entities 跟 ValueObject</li><li>負責所有 Entites 跟 ValueObject 的
<a href=../../../spaces/ddd/invariants rel=noopener>Invariants</a></li><li>Aggregate 即 Transaction Boundary,</li><li>建議一個 Aggregate 應該只對應一個
<a href=../../../spaces/ddd/repository rel=noopener>Repository</a>
, 並在該 Repository 綁上 Transaction</li><li>使用名詞, 不要出現動詞</li><li>避免使用不精確的名詞</li></ul><h2 id=interaction-with-other-aggregate>Interaction with other aggregate</h2><p>如果是要協調調度兩個不同的聚合的情況下，一般我們會考慮是以 Application Service 來處理，或者是通過派發領域事件去跟另一個聚合做交互， domain service 還是比較隸屬於該聚合相關的業務話題的事物居多。</p><h2 id=aggregate-root>Aggregate Root</h2><p>挑選 Aggregate 中的其中一個 Entity 最為 Root (根), 只有 Aggregate Root 持有整體的領域事件 (Domain Event)，並且決定何時發出去。</p><blockquote><p>一個 Aggregate Root擁有 domain event list 就好像是一個汽車修理員隨身攜帶螺絲起子一樣是很自然的事情</p></blockquote></article><hr><div class=page-end><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=../../../spaces/ddd/invariants>/spaces/ddd/invariants</a></li><li><a href=../../../spaces/ddd/strategic-design>/spaces/ddd/strategic-design</a></li><li><a href=../../../spaces/event-sourcing/projection>/spaces/event-sourcing/projection</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script>const index={backlinks:{"/+home":[{source:"/",target:"/+home",text:"enter the forest"}],"/moc/ddd-moc":[{source:"/+home",target:"/moc/ddd-moc",text:"DDD MOC"},{source:"/moc/event-sourcing-moc",target:"/moc/ddd-moc",text:"DDD"},{source:"/spaces/event-sourcing/general-understanding",target:"/moc/ddd-moc",text:"DDD"}],"/moc/event-sourcing-moc":[{source:"/+home",target:"/moc/event-sourcing-moc",text:"Event Sourcing MOC"}],"/moc/kubernetes-moc":[{source:"/+home",target:"/moc/kubernetes-moc",text:"Kubernetes MOC"}],"/moc/spring-moc":[{source:"/+home",target:"/moc/spring-moc",text:"Spring MOC"}],"/moc/umani-moc":[{source:"/+home",target:"/moc/umani-moc",text:"Umani MOC"}],"/notes/config":[{source:"/notes/hosting",target:"/notes/config",text:"Customizing Quartz"},{source:"/notes/troubleshooting",target:"/notes/config",text:"customization guide"}],"/notes/editing":[{source:"/notes/troubleshooting",target:"/notes/editing",text:"local editing"}],"/notes/hosting":[{source:"/notes/troubleshooting",target:"/notes/hosting",text:"the hosting guide"},{source:"/notes/troubleshooting",target:"/notes/hosting",text:"hosting"}],"/notes/ignore-notes":[{source:"/notes/troubleshooting",target:"/notes/ignore-notes",text:"excluding pages from being published"}],"/notes/obsidian":[{source:"/notes/troubleshooting",target:"/notes/obsidian",text:"Obsidian"}],"/notes/troubleshooting":[{source:"/notes/hosting",target:"/notes/troubleshooting",text:"FAQ and Troubleshooting guide"}],"/private/projects/projects-moc":[{source:"/+home",target:"/private/projects/projects-moc",text:"Projects MOC"}],"/spaces/ddd/aggregate":[{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/aggregate",text:"Aggregate"}],"/spaces/ddd/aggregate.md":[{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate.md",text:"Aggregate Root"}],"/spaces/ddd/bounded-context":[{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/bounded-context",text:"Bounded Context"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/bounded-context",text:"Bounded Context"}],"/spaces/ddd/command":[{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/command",text:"Command"}],"/spaces/ddd/domain-modeling":[{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/domain-modeling",text:"Domain"},{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/domain-modeling",text:"Domain Modeling"}],"/spaces/ddd/event":[{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/event",text:"Event"},{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/event",text:"event"}],"/spaces/ddd/example-mapping":[{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/example-mapping",text:"Example Mapping"}],"/spaces/ddd/invariants":[{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/invariants",text:"Invariants"},{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/ddd/invariants",text:"Invariants"}],"/spaces/ddd/repository":[{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/repository",text:"Repository"}],"/spaces/ddd/strategic-design":[{source:"/moc/ddd-moc",target:"/spaces/ddd/strategic-design",text:"Strategic Design"}],"/spaces/ddd/subdomain":[{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/subdomain",text:"Subdomain"}],"/spaces/ddd/tactical-design":[{source:"/moc/ddd-moc",target:"/spaces/ddd/tactical-design",text:"Tactical Design"}],"/spaces/event-sourcing/aggregate-business-invariants":[{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/aggregate-business-invariants",text:"Aggregate Business Invariants"}],"/spaces/event-sourcing/copy-transform":[{source:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"},{source:"/spaces/event-sourcing/remodel-domain",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"}],"/spaces/event-sourcing/create-a-snapshot-of-the-stream":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",text:"Create a Snapshot of the Stream"}],"/spaces/event-sourcing/dealing-with-errors":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/dealing-with-errors",text:"Dealing with Errors"}],"/spaces/event-sourcing/double-write":[{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/double-write",text:"Double Write"}],"/spaces/event-sourcing/general-understanding":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/general-understanding",text:"General Understanding"}],"/spaces/event-sourcing/guarantee-correctness-when-writing":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/guarantee-correctness-when-writing",text:"Guarantee Correctness when writing"}],"/spaces/event-sourcing/handle-versioning":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/handle-versioning",text:"Handle Versioning"}],"/spaces/event-sourcing/manage-transactions-with-database":[{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/manage-transactions-with-database",text:"Manage Transactions With a Database"}],"/spaces/event-sourcing/projection":[{source:"/spaces/event-sourcing/general-understanding",target:"/spaces/event-sourcing/projection",text:"Projection"}],"/spaces/event-sourcing/read-model":[{source:"/spaces/event-sourcing/you-may-not-need-a-read-model",target:"/spaces/event-sourcing/read-model",text:"Read Model"}],"/spaces/event-sourcing/remodel-domain":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/remodel-domain",text:"Re-Model Domain"}],"/spaces/event-sourcing/upcaster":[{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/upcaster",text:"Upcaster"}],"/spaces/event-sourcing/you-may-not-need-a-read-model":[{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/you-may-not-need-a-read-model",text:"You may NOT need a read model"}],"/spaces/kubernetes/assigning-pods":[{source:"/moc/kubernetes-moc",target:"/spaces/kubernetes/assigning-pods",text:"Assigning Pods"}],"/spaces/spring/externalized-configuration":[{source:"/moc/spring-moc",target:"/spaces/spring/externalized-configuration",text:"Externalized Configuration"}],"/spaces/umani/Rime-Input-Method-Engine":[{source:"/moc/umani-moc",target:"/spaces/umani/Rime-Input-Method-Engine",text:"Rime Input Method Engine"}],"/spaces/umani/cdc":[{source:"/moc/umani-moc",target:"/spaces/umani/cdc",text:"Change Data Capture"},{source:"/spaces/event-sourcing/manage-transactions-with-database",target:"/spaces/umani/cdc",text:"CDC"}],"/spaces/umani/json-schema":[{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/umani/json-schema",text:"JSON Schema"}],"/spaces/umani/optimistic-concurrency-control":[{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/umani/optimistic-concurrency-control",text:"Optimistic Concurrency Control"}],"/spaces/umani/single-source-of-truth":[{source:"/spaces/event-sourcing/dealing-with-errors",target:"/spaces/umani/single-source-of-truth",text:"Single Source of Truth"}]},links:{"/":[{source:"/",target:"/+home",text:"enter the forest"}],"/+home":[{source:"/+home",target:"/moc/spring-moc",text:"Spring MOC"},{source:"/+home",target:"/private/projects/projects-moc",text:"Projects MOC"},{source:"/+home",target:"/moc/umani-moc",text:"Umani MOC"},{source:"/+home",target:"/moc/ddd-moc",text:"DDD MOC"},{source:"/+home",target:"/moc/event-sourcing-moc",text:"Event Sourcing MOC"},{source:"/+home",target:"/moc/kubernetes-moc",text:"Kubernetes MOC"}],"/moc/ddd-moc":[{source:"/moc/ddd-moc",target:"/spaces/ddd/tactical-design",text:"Tactical Design"},{source:"/moc/ddd-moc",target:"/spaces/ddd/strategic-design",text:"Strategic Design"}],"/moc/event-sourcing-moc":[{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/domain-modeling",text:"Domain"},{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/bounded-context",text:"Bounded Context"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/general-understanding",text:"General Understanding"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/you-may-not-need-a-read-model",text:"You may NOT need a read model"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/remodel-domain",text:"Re-Model Domain"},{source:"/moc/event-sourcing-moc",target:"/moc/ddd-moc",text:"DDD"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/handle-versioning",text:"Handle Versioning"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",text:"Create a Snapshot of the Stream"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/dealing-with-errors",text:"Dealing with Errors"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/guarantee-correctness-when-writing",text:"Guarantee Correctness when writing"}],"/moc/kubernetes-moc":[{source:"/moc/kubernetes-moc",target:"/spaces/kubernetes/assigning-pods",text:"Assigning Pods"}],"/moc/spring-moc":[{source:"/moc/spring-moc",target:"/spaces/spring/externalized-configuration",text:"Externalized Configuration"}],"/moc/umani-moc":[{source:"/moc/umani-moc",target:"/spaces/umani/Rime-Input-Method-Engine",text:"Rime Input Method Engine"},{source:"/moc/umani-moc",target:"/spaces/umani/cdc",text:"Change Data Capture"}],"/notes/hosting":[{source:"/notes/hosting",target:"/notes/config",text:"Customizing Quartz"},{source:"/notes/hosting",target:"/notes/troubleshooting",text:"FAQ and Troubleshooting guide"}],"/notes/troubleshooting":[{source:"/notes/troubleshooting",target:"/notes/ignore-notes",text:"excluding pages from being published"},{source:"/notes/troubleshooting",target:"/notes/obsidian",text:"Obsidian"},{source:"/notes/troubleshooting",target:"/notes/hosting",text:"the hosting guide"},{source:"/notes/troubleshooting",target:"/notes/editing",text:"local editing"},{source:"/notes/troubleshooting",target:"/notes/hosting",text:"hosting"},{source:"/notes/troubleshooting",target:"/notes/config",text:"customization guide"}],"/spaces/ddd/aggregate":[{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/invariants",text:"Invariants"},{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/repository",text:"Repository"}],"/spaces/ddd/invariants":[{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate.md",text:"Aggregate Root"}],"/spaces/ddd/strategic-design":[{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/bounded-context",text:"Bounded Context"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/subdomain",text:"Subdomain"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/event",text:"Event"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/command",text:"Command"}],"/spaces/ddd/tactical-design":[{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/example-mapping",text:"Example Mapping"},{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/domain-modeling",text:"Domain Modeling"}],"/spaces/event-sourcing/aggregate-business-invariants":[{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/ddd/invariants",text:"Invariants"},{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/umani/optimistic-concurrency-control",text:"Optimistic Concurrency Control"}],"/spaces/event-sourcing/create-a-snapshot-of-the-stream":[{source:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"}],"/spaces/event-sourcing/dealing-with-errors":[{source:"/spaces/event-sourcing/dealing-with-errors",target:"/spaces/umani/single-source-of-truth",text:"Single Source of Truth"}],"/spaces/event-sourcing/general-understanding":[{source:"/spaces/event-sourcing/general-understanding",target:"/moc/ddd-moc",text:"DDD"},{source:"/spaces/event-sourcing/general-understanding",target:"/spaces/event-sourcing/projection",text:"Projection"}],"/spaces/event-sourcing/guarantee-correctness-when-writing":[{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/manage-transactions-with-database",text:"Manage Transactions With a Database"},{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/aggregate-business-invariants",text:"Aggregate Business Invariants"}],"/spaces/event-sourcing/handle-versioning":[{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/upcaster",text:"Upcaster"},{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/umani/json-schema",text:"JSON Schema"},{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/double-write",text:"Double Write"}],"/spaces/event-sourcing/manage-transactions-with-database":[{source:"/spaces/event-sourcing/manage-transactions-with-database",target:"/spaces/umani/cdc",text:"CDC"}],"/spaces/event-sourcing/projection":[{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/event",text:"event"},{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/aggregate",text:"Aggregate"}],"/spaces/event-sourcing/remodel-domain":[{source:"/spaces/event-sourcing/remodel-domain",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"}],"/spaces/event-sourcing/you-may-not-need-a-read-model":[{source:"/spaces/event-sourcing/you-may-not-need-a-read-model",target:"/spaces/event-sourcing/read-model",text:"Read Model"}]}},links=[{source:"/+home",target:"/moc/spring-moc",text:"Spring MOC"},{source:"/+home",target:"/private/projects/projects-moc",text:"Projects MOC"},{source:"/+home",target:"/moc/umani-moc",text:"Umani MOC"},{source:"/+home",target:"/moc/ddd-moc",text:"DDD MOC"},{source:"/+home",target:"/moc/event-sourcing-moc",text:"Event Sourcing MOC"},{source:"/+home",target:"/moc/kubernetes-moc",text:"Kubernetes MOC"},{source:"/",target:"/+home",text:"enter the forest"},{source:"/moc/ddd-moc",target:"/spaces/ddd/tactical-design",text:"Tactical Design"},{source:"/moc/ddd-moc",target:"/spaces/ddd/strategic-design",text:"Strategic Design"},{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/domain-modeling",text:"Domain"},{source:"/moc/event-sourcing-moc",target:"/spaces/ddd/bounded-context",text:"Bounded Context"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/general-understanding",text:"General Understanding"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/you-may-not-need-a-read-model",text:"You may NOT need a read model"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/remodel-domain",text:"Re-Model Domain"},{source:"/moc/event-sourcing-moc",target:"/moc/ddd-moc",text:"DDD"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/handle-versioning",text:"Handle Versioning"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",text:"Create a Snapshot of the Stream"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/dealing-with-errors",text:"Dealing with Errors"},{source:"/moc/event-sourcing-moc",target:"/spaces/event-sourcing/guarantee-correctness-when-writing",text:"Guarantee Correctness when writing"},{source:"/moc/kubernetes-moc",target:"/spaces/kubernetes/assigning-pods",text:"Assigning Pods"},{source:"/moc/spring-moc",target:"/spaces/spring/externalized-configuration",text:"Externalized Configuration"},{source:"/moc/umani-moc",target:"/spaces/umani/Rime-Input-Method-Engine",text:"Rime Input Method Engine"},{source:"/moc/umani-moc",target:"/spaces/umani/cdc",text:"Change Data Capture"},{source:"/notes/hosting",target:"/notes/config",text:"Customizing Quartz"},{source:"/notes/hosting",target:"/notes/troubleshooting",text:"FAQ and Troubleshooting guide"},{source:"/notes/troubleshooting",target:"/notes/ignore-notes",text:"excluding pages from being published"},{source:"/notes/troubleshooting",target:"/notes/obsidian",text:"Obsidian"},{source:"/notes/troubleshooting",target:"/notes/hosting",text:"the hosting guide"},{source:"/notes/troubleshooting",target:"/notes/editing",text:"local editing"},{source:"/notes/troubleshooting",target:"/notes/hosting",text:"hosting"},{source:"/notes/troubleshooting",target:"/notes/config",text:"customization guide"},{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/invariants",text:"Invariants"},{source:"/spaces/ddd/aggregate",target:"/spaces/ddd/repository",text:"Repository"},{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/ddd/invariants",target:"/spaces/ddd/aggregate.md",text:"Aggregate Root"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/bounded-context",text:"Bounded Context"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/subdomain",text:"Subdomain"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/event",text:"Event"},{source:"/spaces/ddd/strategic-design",target:"/spaces/ddd/command",text:"Command"},{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/example-mapping",text:"Example Mapping"},{source:"/spaces/ddd/tactical-design",target:"/spaces/ddd/domain-modeling",text:"Domain Modeling"},{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/ddd/invariants",text:"Invariants"},{source:"/spaces/event-sourcing/aggregate-business-invariants",target:"/spaces/umani/optimistic-concurrency-control",text:"Optimistic Concurrency Control"},{source:"/spaces/event-sourcing/create-a-snapshot-of-the-stream",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"},{source:"/spaces/event-sourcing/dealing-with-errors",target:"/spaces/umani/single-source-of-truth",text:"Single Source of Truth"},{source:"/spaces/event-sourcing/general-understanding",target:"/moc/ddd-moc",text:"DDD"},{source:"/spaces/event-sourcing/general-understanding",target:"/spaces/event-sourcing/projection",text:"Projection"},{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/manage-transactions-with-database",text:"Manage Transactions With a Database"},{source:"/spaces/event-sourcing/guarantee-correctness-when-writing",target:"/spaces/event-sourcing/aggregate-business-invariants",text:"Aggregate Business Invariants"},{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/upcaster",text:"Upcaster"},{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/umani/json-schema",text:"JSON Schema"},{source:"/spaces/event-sourcing/handle-versioning",target:"/spaces/event-sourcing/double-write",text:"Double Write"},{source:"/spaces/event-sourcing/manage-transactions-with-database",target:"/spaces/umani/cdc",text:"CDC"},{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/event",text:"event"},{source:"/spaces/event-sourcing/projection",target:"/spaces/ddd/aggregate",text:"Aggregate"},{source:"/spaces/event-sourcing/remodel-domain",target:"/spaces/event-sourcing/copy-transform",text:"Copy Transform"},{source:"/spaces/event-sourcing/you-may-not-need-a-read-model",target:"/spaces/event-sourcing/read-model",text:"Read Model"}],curPage="/spaces/ddd/aggregate",pathColors=[{"/moc":"#4388cc"}],parseIdsFromLinks=a=>[...new Set(a.flatMap(a=>[a.source,a.target]))],data={nodes:parseIdsFromLinks(links).map(a=>({id:a})),links},color=a=>{if(a.id===curPage||a.id==="/"&&curPage==="")return"var(--g-node-active)";for(const b of pathColors){const c=Object.keys(b)[0],d=b[c];if(a.id.startsWith(c))return d}return"var(--g-node)"},drag=c=>{function d(b,a){b.active||c.alphaTarget(1).restart(),a.fx=a.x,a.fy=a.y}function e(a,b){b.fx=a.x,b.fy=a.y}function f(b,a){b.active||c.alphaTarget(0),a.fx=null,a.fy=null}const a=!0,b=()=>{};return d3.drag().on("start",a?d:b).on("drag",a?e:b).on("end",a?f:b)},height=250,width=document.getElementById("graph-container").offsetWidth,simulation=d3.forceSimulation(data.nodes).force("charge",d3.forceManyBody().strength(-20)).force("link",d3.forceLink(data.links).id(a=>a.id)).force("center",d3.forceCenter()),svg=d3.select('#graph-container').append('svg').attr('width',width).attr('height',height).attr("viewBox",[-width/2,-height/2,width,height]),enableLegend=!1;if(enableLegend){const a=[{Current:"var(--g-node-active)"},{Note:"var(--g-node)"},...pathColors];a.forEach((a,b)=>{const c=Object.keys(a)[0],d=a[c];svg.append("circle").attr("cx",-width/2+20).attr("cy",height/2-30*(b+1)).attr("r",6).style("fill",d),svg.append("text").attr("x",-width/2+40).attr("y",height/2-30*(b+1)).text(c).style("font-size","15px").attr("alignment-baseline","middle")})}const link=svg.append("g").selectAll("line").data(data.links).join("line").attr("class","link").attr("stroke","var(--g-link)").attr("stroke-width",2).attr("data-source",a=>a.source.id).attr("data-target",a=>a.target.id),graphNode=svg.append("g").selectAll("g").data(data.nodes).enter().append("g"),node=graphNode.append("circle").attr("class","node").attr("id",a=>a.id).attr("r",a=>{const b=index.links[a.id]?.length||0,c=index.backlinks[a.id]?.length||0;return 3+(b+c)/4}).attr("fill",color).style("cursor","pointer").on("click",(b,a)=>{window.location.href="https://shihyuho.github.io/pkm/"+a.id.replace(" ","-").replace("%20","-")}).on("mouseover",function(f,a){d3.selectAll(".node").transition().duration(100).attr("fill","var(--g-node-inactive)");const c=parseIdsFromLinks([...index.links[a.id]||[],...index.backlinks[a.id]||[]]),d=d3.selectAll(".node").filter(a=>c.includes(a.id)),b=a.id,e=d3.selectAll(".link").filter(a=>a.source.id===b||a.target.id===b);d.transition().duration(200).attr("fill",color),e.transition().duration(200).attr("stroke","var(--g-link-active)"),d3.select(this.parentNode).select("text").raise().transition().duration(200).style("opacity",1)}).on("mouseleave",function(d,b){d3.selectAll(".node").transition().duration(200).attr("fill",color);const a=b.id,c=d3.selectAll(".link").filter(b=>b.source.id===a||b.target.id===a);c.transition().duration(200).attr("stroke","var(--g-link)"),d3.select(this.parentNode).select("text").transition().duration(200).style("opacity",0)}).call(drag(simulation)),labels=graphNode.append("text").attr("dx",12).attr("dy",".35em").text(a=>a.id.replace("%20","-")).style("opacity",0).style("pointer-events","none").call(drag(simulation)),enableZoom=!0;enableZoom&&svg.call(d3.zoom().extent([[0,0],[width,height]]).scaleExtent([.25,4]).on("zoom",({transform:a})=>{link.attr("transform",a),node.attr("transform",a),labels.attr("transform",a)})),simulation.on("tick",()=>{link.attr("x1",a=>a.source.x).attr("y1",a=>a.source.y).attr("x2",a=>a.target.x).attr("y2",a=>a.target.y),node.attr("cx",a=>a.x).attr("cy",a=>a.y),labels.attr("x",a=>a.x).attr("y",a=>a.y)})</script></div></div><div id=contact_buttons><footer><p>Made by Shihyu Ho using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2021</p><a href=../../../>Home</a>
<a href=https://github.com/shihyuho/>GitHub</a><a href=https://www.linkedin.com/in/methodho/>LinkedIn</a><a href=https://www.facebook.com/evermatt/>Facebook</a></footer></div></div></body></html>